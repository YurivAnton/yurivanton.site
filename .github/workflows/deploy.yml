on:
    push:
      branches:
        - main
jobs:

  deploy:
    name: Deploy
    runs-on: ubuntu-latest
    steps:
      - name: SSH Deploy
        uses: appleboy/ssh-action@master
        with:
          host: shell.r6.websupport.sk
          username: uid5485023
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          port: 26641
          script: | 
            cd ~/yurivanton.site/web/
            php artisan down
            git pull
            composer install --no-dev --no-interaction --prefer-dist --optimize-autoloader
            php artisan migrate --force
            npm run
            php artisan optimize:clear
            php artisan optimize
            php artisan queue:restart
            php artisan up