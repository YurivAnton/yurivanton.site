name: üöÄ FTP Deploy to Websupport

on:
  push:
    branches:
      - main  # –ó–∞–º—ñ–Ω–∏ –Ω–∞ —Å–≤–æ—é –≥—ñ–ª–∫—É, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ

jobs:
  ftp-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: üì• Checkout code
        uses: actions/checkout@v3

      - name: üõ† Install Composer dependencies (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
        run: composer install --no-dev --prefer-dist --optimize-autoloader

      - name: üßº Cleanup (–æ–ø—Ü—ñ–π–Ω–æ)
        run: |
          rm -rf tests
          rm -rf .git
          rm -rf node_modules

      - name: üì§ FTP Deploy
        uses: SamKirkland/FTP-Deploy-Action@v4
        with:
          ftp-server: ${{ secrets.FTP_HOST }}
          ftp-username: ${{ secrets.FTP_USERNAME }}
          ftp-password: ${{ secrets.FTP_PASSWORD }}
          ftp-port: 21
          remote-dir: /web/   # –ó–∞–º—ñ–Ω–∏ –Ω–∞ —Ç–≤—ñ–π —à–ª—è—Ö
          local-dir: ./       # –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –≤—Å—ñ –ª–æ–∫–∞–ª—å–Ω—ñ —Ñ–∞–π–ª–∏
          exclude: |
            **/.git*
            **/.github*
            **/node_modules/**
            **/tests/**
            .env
            README.md
